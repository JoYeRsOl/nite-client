(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{806:e=>{e.exports={voiceRoom:"voice-room_voiceRoom__Z2Hov",videoFrame:"voice-room_videoFrame__gBw9g",videoFeed:"voice-room_videoFeed__YzH1d",video:"voice-room_video__cz1ZP",voiceRoomActionBar:"voice-room_voiceRoomActionBar__W1uH7"}},1226:()=>{},2531:(e,t,o)=>{"use strict";let n;o.d(t,{qU:()=>a,sM:()=>s,cH:()=>c,sZ:()=>n,t5:()=>u,dS:()=>l,LV:()=>i});var r=o(4298);function c(){if(!n)return void console.log("Socket not initialized, cannot connect");n.connected||n.connect()}function s(){n&&n.disconnect()}function i(e){(n=(0,r.io)(e,{autoConnect:!1,extraHeaders:{"ngrok-skip-browser-warning":"123"}})).on("connect_error",e=>{console.log("connect_error due to ".concat(e.message)),console.log("connect_error due to ".concat(e.name)),console.log("connect_error due to ".concat(e.stack))})}var a=function(e){return e.Call="Call",e.Camera="Camera",e.Microphone="Microphone",e.Sound="Sound",e}({});let u={Call:"./icon/voiceroom-call-off.svg",Camera:"./icon/voiceroom-camera-off.svg",Microphone:"./icon/voiceroom-microphone-off.svg",Sound:"./icon/voiceroom-sound-off.svg"},l={Call:"./icon/voiceroom-call-on.svg",Camera:"./icon/voiceroom-camera-on.svg",Microphone:"./icon/voiceroom-microphone-on.svg",Sound:"./icon/voiceroom-sound-on.svg"}},3180:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"errorOnce",{enumerable:!0,get:function(){return o}});let o=e=>{}},3262:(e,t,o)=>{"use strict";o.d(t,{d:()=>a});var n=o(5155),r=o(2531),c=o(8457),s=o(2115),i=o(6278);function a(){let e=(0,s.useContext)(i.TP);return(0,n.jsx)(c.f,{icon:r.qU.Microphone,onClick:t=>{e.setState({...e.context,microphoneMuted:t})}})}},3409:(e,t,o)=>{"use strict";o.d(t,{$:()=>i});var n=o(5155),r=o(4493),c=o(806),s=o.n(c);function i(e){let{streams:t}=e;return(0,n.jsx)("div",{className:s().videoFrame,children:t.map(e=>(0,n.jsx)(r.K,{mediaStream:e.mediaStream,isMuted:e.isMuted}))})}},4493:(e,t,o)=>{"use strict";o.d(t,{K:()=>i});var n=o(5155),r=o(2115),c=o(806),s=o.n(c);function i(e){let{mediaStream:t,isMuted:o=!1}=e,c=(0,r.useRef)(null);return(0,r.useEffect)(()=>{c.current&&t&&(c.current.srcObject=t)},[t]),(0,n.jsx)("div",{className:s().videoFeed,children:(0,n.jsx)("video",{className:s().video,ref:c,autoPlay:!0,playsInline:!0,muted:o})})}},5784:(e,t,o)=>{Promise.resolve().then(o.bind(o,6250))},6247:e=>{e.exports={toggleButton:"toggle-button_toggleButton__xEj1Z"}},6250:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var n=o(5155),r=o(2115),c=o(6874),s=o.n(c),i=o(9459),a=o.n(i);function u(e){let{roomName:t,serverUrl:o,setRoomName:r,setServerUrl:c}=e;return(0,n.jsxs)("div",{className:a().roomProperties,children:[(0,n.jsx)("input",{className:a().inputEnabled,placeholder:"Server URL (e.g., localhost:3333)",type:"text",value:o,onChange:e=>c(e.currentTarget.value)}),(0,n.jsx)("input",{className:a().inputEnabled,placeholder:"Room Name",type:"text",value:t,onChange:e=>r(e.currentTarget.value)})]})}function l(){let[e,t]=(0,r.useState)(""),[o,c]=(0,r.useState)("localhost:3333");return console.log("serverUrl",o),console.log("roomName",e),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Welcome to Zov-client!"}),(0,n.jsx)(u,{serverUrl:o,roomName:e,setServerUrl:c,setRoomName:t}),(0,n.jsx)(s(),{href:{pathname:"/server",query:{serverUrl:o,roomName:e}},children:"Server"})]})}o(7718),o(9743),o(6417),o(8457),o(3262),o(4493),o(3409),o(6278)},6278:(e,t,o)=>{"use strict";o.d(t,{TP:()=>h,mr:()=>g});var n=o(5155),r=o(2115),c=o(806),s=o.n(c),i=o(2531),a=o(9335),u=o(5695),l=o(7718),d=o(6417),f=o(3262),p=o(9743),m=o(3409);let v={microphoneMuted:!1,soundMuted:!1,video:!0},h=(0,r.createContext)({context:v,setState:()=>{}});function g(e){let{localStream:t}=e,[o,c]=(0,r.useState)(v),l=(0,u.useSearchParams)(),d=l.get("roomName")||"",f=l.get("serverUrl")||"";(0,r.useEffect)(()=>((0,i.LV)(f),()=>{(0,i.sM)()}));let p=(0,a.yK)({localStream:t,roomName:d});(0,a.ow)({peerConnection:p.peerConnection,roomName:d}),(0,r.useEffect)(()=>{t&&(t.getAudioTracks()[0].enabled=o.microphoneMuted)},[o.microphoneMuted]),(0,r.useEffect)(()=>{p.guestStream&&(p.guestStream.getAudioTracks()[0].enabled=o.microphoneMuted)},[o.soundMuted]),(0,r.useEffect)(()=>{t&&(t.getVideoTracks()[0].enabled=o.video)},[o.video]);let g=[];return t&&g.push({mediaStream:t,isMuted:!0}),p.guestStream&&g.push({mediaStream:p.guestStream,isMuted:!1}),(0,n.jsx)("div",{className:s().voiceRoom,children:(0,n.jsxs)(h.Provider,{value:{context:o,setState:c},children:[(0,n.jsx)(m.$,{streams:g}),(0,n.jsx)(_,{})]})})}function _(){return(0,n.jsxs)("div",{className:s().voiceRoomActionBar,children:[(0,n.jsx)(f.d,{}),(0,n.jsx)(p.u,{}),(0,n.jsx)(d.G,{}),(0,n.jsx)(l.Q,{})]})}},6417:(e,t,o)=>{"use strict";o.d(t,{G:()=>a});var n=o(5155),r=o(2531),c=o(8457),s=o(2115),i=o(6278);function a(){let e=(0,s.useContext)(i.TP);return(0,n.jsx)(c.f,{icon:r.qU.Camera,onClick:t=>{e.setState({...e.context,video:t})}})}},6874:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var o in t)Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}(t,{default:function(){return h},useLinkStatus:function(){return _}});let n=o(6966),r=o(5155),c=n._(o(2115)),s=o(2757),i=o(5227),a=o(9818),u=o(6654),l=o(9991),d=o(5929);o(3230);let f=o(4930),p=o(2664),m=o(6634);function v(e){return"string"==typeof e?e:(0,s.formatUrl)(e)}function h(e){let t,o,n,[s,h]=(0,c.useOptimistic)(f.IDLE_LINK_STATUS),_=(0,c.useRef)(null),{href:C,as:x,children:S,prefetch:j=null,passHref:b,replace:y,shallow:E,scroll:k,onClick:M,onMouseEnter:T,onTouchStart:P,legacyBehavior:w=!1,onNavigate:N,ref:R,unstable_dynamicOnHover:U,...L}=e;t=S,w&&("string"==typeof t||"number"==typeof t)&&(t=(0,r.jsx)("a",{children:t}));let Z=c.default.useContext(i.AppRouterContext),A=!1!==j,O=null===j?a.PrefetchKind.AUTO:a.PrefetchKind.FULL,{href:I,as:K}=c.default.useMemo(()=>{let e=v(C);return{href:e,as:x?v(x):e}},[C,x]);w&&(o=c.default.Children.only(t));let D=w?o&&"object"==typeof o&&o.ref:R,B=c.default.useCallback(e=>(null!==Z&&(_.current=(0,f.mountLinkInstance)(e,I,Z,O,A,h)),()=>{_.current&&((0,f.unmountLinkForCurrentNavigation)(_.current),_.current=null),(0,f.unmountPrefetchableInstance)(e)}),[A,I,Z,O,h]),F={ref:(0,u.useMergedRef)(B,D),onClick(e){w||"function"!=typeof M||M(e),w&&o.props&&"function"==typeof o.props.onClick&&o.props.onClick(e),Z&&(e.defaultPrevented||function(e,t,o,n,r,s,i){let{nodeName:a}=e.currentTarget;if(!("A"===a.toUpperCase()&&function(e){let t=e.currentTarget.getAttribute("target");return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||e.currentTarget.hasAttribute("download"))){if(!(0,p.isLocalURL)(t)){r&&(e.preventDefault(),location.replace(t));return}e.preventDefault(),c.default.startTransition(()=>{if(i){let e=!1;if(i({preventDefault:()=>{e=!0}}),e)return}(0,m.dispatchNavigateAction)(o||t,r?"replace":"push",null==s||s,n.current)})}}(e,I,K,_,y,k,N))},onMouseEnter(e){w||"function"!=typeof T||T(e),w&&o.props&&"function"==typeof o.props.onMouseEnter&&o.props.onMouseEnter(e),Z&&A&&(0,f.onNavigationIntent)(e.currentTarget,!0===U)},onTouchStart:function(e){w||"function"!=typeof P||P(e),w&&o.props&&"function"==typeof o.props.onTouchStart&&o.props.onTouchStart(e),Z&&A&&(0,f.onNavigationIntent)(e.currentTarget,!0===U)}};return(0,l.isAbsoluteUrl)(K)?F.href=K:w&&!b&&("a"!==o.type||"href"in o.props)||(F.href=(0,d.addBasePath)(K)),n=w?c.default.cloneElement(o,F):(0,r.jsx)("a",{...L,...F,children:t}),(0,r.jsx)(g.Provider,{value:s,children:n})}o(3180);let g=(0,c.createContext)(f.IDLE_LINK_STATUS),_=()=>(0,c.useContext)(g);("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7718:(e,t,o)=>{"use strict";o.d(t,{Q:()=>i});var n=o(5155),r=o(2531),c=o(8457),s=o(3784);function i(){let e=(0,s.useRouter)();return(0,n.jsx)(c.f,{icon:r.qU.Call,onClick:()=>{e.push("/")}})}},8457:(e,t,o)=>{"use strict";o.d(t,{f:()=>u});var n=o(5155),r=o(6247),c=o.n(r),s=o(6766),i=o(2115),a=o(2531);function u(e){let{icon:t,onClick:o}=e,[r,u]=(0,i.useState)(a.dS[t]),[l,d]=(0,i.useState)(!0);return console.log("State: ".concat(l," icon: ").concat(r)),(0,i.useEffect)(()=>{u(l?a.t5[null!=t?t:a.qU.Sound]:a.dS[null!=t?t:a.qU.Sound])},[l]),(0,n.jsx)("div",{className:c().toggleButton,onClick:()=>{d(!l),o&&o(!l)},children:(0,n.jsx)(s.default,{src:r,alt:"pohui mne",width:24,height:24})})}},9335:(e,t,o)=>{"use strict";o.d(t,{ow:()=>c,WO:()=>s,yK:()=>i});var n=o(2115),r=o(2531);function c(e){let{peerConnection:t,roomName:o}=e;console.log("useChatConnection:".concat(o,":").concat(t));let{sendOffer:c}=function(e){let{peerConnection:t,roomName:o}=e;return{sendOffer:(0,n.useCallback)(async()=>{if(!t||!o)return;console.log("useOfferSending");let e=await t.createOffer();await t.setLocalDescription(e),r.sZ.emit("send_connection_offer",{roomName:o,offer:e})},[o,t])}}({peerConnection:t,roomName:o}),{handleConnectionOffer:s}=function(e){let{peerConnection:t,roomName:o}=e;return{handleConnectionOffer:(0,n.useCallback)(async e=>{let{offer:n}=e;if(!t||!o)return;console.log("useSendingAnswer"),await t.setRemoteDescription(n);let c=await t.createAnswer();await t.setLocalDescription(c),r.sZ.emit("answer",{answer:c,roomName:o})},[o,t])}}({peerConnection:t,roomName:o}),{handleOfferAnswer:i}={handleOfferAnswer:(0,n.useCallback)(e=>{let{answer:o}=e;t&&(console.log("useAnswerProcessing"),t.setRemoteDescription(o))},[t])},a=(0,n.useCallback)(()=>{r.sZ.emit("join_room",o)},[o]),u=(0,n.useCallback)(e=>{let{candidate:o}=e;t&&t.addIceCandidate(o)},[t]);(0,n.useEffect)(()=>{if(r.sZ&&t)return(0,r.cH)(),r.sZ.on("answer",i),r.sZ.on("send_connection_offer",s),r.sZ.on("another_person_ready",c),r.sZ.on("connect",a),r.sZ.on("send_candidate",u),()=>{r.sZ.off("answer",i),r.sZ.off("send_connection_offer",s),r.sZ.off("another_person_ready",c),r.sZ.off("connect",a),r.sZ.off("send_candidate",u)}},[o,a,s,i,c,u])}function s(){let[e,t]=(0,n.useState)();return(0,n.useEffect)(()=>{navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(e=>{t(e)})},[]),{localStream:e}}function i(e){let{roomName:t,localStream:o}=e,[c,s]=(0,n.useState)();return{peerConnection:(0,n.useMemo)(()=>{if(o&&t){let e=new RTCPeerConnection({iceServers:[{urls:"stun:stun2.1.google.com:19302"}]});return e.addEventListener("icecandidate",e=>{let{candidate:o}=e;o&&r.sZ.emit("send_candidate",{candidate:o,roomName:t})}),e.addEventListener("track",e=>{let{streams:t}=e;console.log("Received remote track:",t),t&&t[0]&&s(t[0])}),e.addEventListener("connectionstatechange",()=>{console.log("Connection state:",e.connectionState)}),e.addEventListener("iceconnectionstatechange",()=>{console.log("ICE connection state:",e.iceConnectionState)}),o.getTracks().forEach(t=>{e.addTrack(t,o)}),e}},[o]),guestStream:c}}},9459:e=>{e.exports={roomProperties:"room-properties_roomProperties__DRlpY",inputEnabled:"room-properties_inputEnabled__zE6R_",inputHover:"room-properties_inputHover__3chqJ",inputFocus:"room-properties_inputFocus__0BY_C",label:"room-properties_label__BiGMm",placeholder:"room-properties_placeholder__IXEuj"}},9743:(e,t,o)=>{"use strict";o.d(t,{u:()=>a});var n=o(5155),r=o(2531),c=o(8457),s=o(6278),i=o(2115);function a(){let e=(0,i.useContext)(s.TP);return(0,n.jsx)(c.f,{icon:r.qU.Sound,onClick:t=>{e.setState({...e.context,soundMuted:t})}})}}},e=>{var t=t=>e(e.s=t);e.O(0,[16,295,194,441,684,358],()=>t(5784)),_N_E=e.O()}]);